import*as t from"d3";var a={126:(t,a,l)=>{l.d(a,{Aw:()=>c,Gi:()=>e,Iy:()=>i,Mr:()=>n,Yh:()=>s,jx:()=>r,mb:()=>o}),l(507);let e=l(625).O1,r={},s={},o={},c={plotName:new Set,xscaleTag:new Set,yscaleTag:new Set,yaxisTag:new Set},n={};function i(){const t={};return Object.keys(o).forEach((a=>{const l=o[a].plotType;t[l]||(t[l]=[]),t[l].push(a)})),t}},287:(t,a,l)=>{l.d(a,{$M:()=>i,D1:()=>o,Gu:()=>p,L3:()=>m,U4:()=>s,gl:()=>n,xR:()=>c});var e=l(507),r=l(126);function s(t,a,l,r,s,o,c,n){const i=e.line().x(((t,l)=>r(a[l]))).y(((t,a)=>s(l[a])));t.append("path").datum(l).attr("class",`all allplot lineplot linePlot-${o}`).attr("clip-path",`url(#clip-${c})`).attr("fill","none").attr("stroke",n).attr("stroke-width",2).attr("d",i)}function o(t,a,l,e,r,s,o,c,n){const i=e(a[1])-e(a[0]);t.selectAll(".bar").data(l).enter().append("rect").attr("class",`all allplot barplot barplot-${s}`).attr("clip-path",`url(#clip-${o})`).attr("x",((t,l)=>e(a[l])-i/4)).attr("y",(t=>r(t))).attr("width",i/2).attr("height",(t=>c[0]-r(t))).attr("fill",n)}function c(t,a,l,r,s,o){a.forEach(((a,c)=>{const n=a.x.reduce(((t,a)=>t+a),0)/a.x.length,i=a.y.reduce(((t,a)=>t+a),0)/a.y.length,m=e.line().x(((t,e)=>l(a.x[e]))).y(((t,l)=>r(a.y[l])));t.append("path").datum(a.y).attr("class",`all allplot multilineplot multilineplot-${a.label}`).attr("clip-path",`url(#clip-${s})`).attr("fill","none").attr("stroke",o).attr("stroke-width",1).attr("d",m),t.append("text").attr("x",l(n)).attr("y",r(i)-10).attr("fill",o).attr("class",`all multilineplot avg-label-${a.label}`).text(`${a.label}`)}))}function n(t,a,l,e,r,s,o,c,n){const i=e(a[1])-e(a[0]),m=Object.keys(l).length,p=i-.2*i,b=p/m;Object.keys(l).forEach(((i,y)=>{const x=l[i];t.selectAll(`.bar-${i}`).data(x).enter().append("rect").attr("class",`all allplot mulitbarplot mulitbarplot-${s} bar-${i}`).attr("clip-path",`url(#clip-${o})`).attr("x",((t,l)=>e(a[l])-p/2+y*b+(p-b*m)/2)).attr("y",(t=>r(t))).attr("width",b).attr("height",(t=>c[0]-r(t))).attr("fill",n[i])}))}function i(t,a,l,e,r,s,o,c,n,i){const m=o(1)-o(0),p=a,b=t.selectAll(".wickplot").data(p),y=t.selectAll(".candleplot").data(p);b.enter().append("line").attr("class",`all ohlcplot wickplot wickplot-${n}`).attr("clip-path",`url(#clip-${i})`).merge(b).attr("x1",((t,l)=>o(a[l]))).attr("y1",((t,a)=>c(e[a]))).attr("x2",((t,l)=>o(a[l]))).attr("y2",((t,a)=>c(r[a]))).attr("stroke","black").attr("stroke-width",1),b.exit().remove(),y.enter().append("rect").attr("class",`all ohlcplot candleplot candleplot-${n}`).attr("clip-path",`url(#clip-${i})`).merge(y).attr("x",((t,l)=>o(a[l])-m/4)).attr("y",((t,a)=>c(Math.max(l[a],s[a])))).attr("width",m/2).attr("height",((t,a)=>0==Math.abs(c(l[a])-c(s[a]))?.001*c(s[a]):Math.abs(c(l[a])-c(s[a])))).attr("fill",((t,a)=>l[a]>s[a]?"red":"green")).attr("stroke","black").attr("stroke-width",1),y.exit().remove()}function m(t,a,l,e,r,s,o){t.selectAll(".scatter-point").data(a).enter().append("circle").attr("class",` all scatterplot scatter-point  scatter-point-${r}`).attr("clip-path",`url(#clip-${s})`).attr("cx",(t=>l(t.xData))).attr("cy",(t=>e(t.yData))).attr("r",(t=>t.size)).attr("fill",(t=>t.color)).attr("stroke","none"),o&&t.selectAll(".scatter-label").data(a).enter().append("text").attr("class",`all scatterplot scatter-label scatter-label-${r}`).attr("clip-path",`url(#clip-${s})`).attr("x",(t=>l(t.xData)+5)).attr("y",(t=>e(t.yData)-5)).text((t=>t.label)).attr("fill","black").style("font-size","10px")}function p(t,a,l,e,s,o){const c=.01,n=t.selectAll(".backtestplot").data(a);n.enter().append("path").attr("class",`all backtestplot backtestplot-${s}`).attr("clip-path",`url(#clip-${o})`).attr("d",(t=>{const a=l(t.index),s=t.index,o=r.Gi.low[s],n=r.Gi.high[s];return"trigger"===t.buyorsell||"PatternBaseIndex"===t.buyorsell?`M${a-8},${e(o-o*c)-8} h16 v16 h-16 Z`:"buy"===t.buyorsell?`M${a},${e(o-o*c)-8} l8,16 l-16,0 Z`:"sell"===t.buyorsell?`M${a},${e(n+n*c)+8} l8,-16 l-16,0 Z`:null})).attr("fill",(t=>"trigger"===t.buyorsell?"blue":"buy"===t.buyorsell?"cyan":"sell"===t.buyorsell?t.pnl&&t.pnl>0?"green":"red":"PatternBaseIndex"===t.buyorsell?"yellow":"brown")).attr("stroke","black").attr("stroke-width",1),n.exit().remove()}},625:(t,a,l)=>{l.d(a,{O1:()=>e});const e={timestamp:[],xindex:[],open:[],high:[],low:[],close:[],volume:[]}},507:(a,l,e)=>{var r,s;a.exports=(r={line:()=>t.line},s={},e.d(s,r),s)}},l={};function e(t){var r=l[t];if(void 0!==r)return r.exports;var s=l[t]={exports:{}};return a[t](s,s.exports,e),s.exports}e.d=(t,a)=>{for(var l in a)e.o(a,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:a[l]})},e.o=(t,a)=>Object.prototype.hasOwnProperty.call(t,a);var r={};(()=>{e.d(r,{v:()=>l});var t=e(126),a=e(287);function l(a,l,e){const r=Array.from(t.Aw.plotName),b=(0,t.Iy)();a.selectAll(".lineplot").remove(),a.selectAll(".barplot").remove(),a.selectAll(".ohlcplot").remove(),a.selectAll(".scatterplot").remove(),a.selectAll(".mulitbarplot").remove(),a.selectAll(".multilineplot").remove(),a.selectAll(".backtestplot").remove();for(let t in b)Object.prototype.hasOwnProperty.call(b,t)&&("line"==t&&b[t].forEach((t=>{r.includes(t)&&c(t,a,l)})),"multiline"==t&&b[t].forEach((t=>{r.includes(t)&&n(t,a,l)})),"bar"==t&&b[t].forEach((t=>{r.includes(t)&&i(t,a,l)})),"mulitbar"==t&&b[t].forEach((t=>{r.includes(t)&&m(t,a,l)})),"ohlc"==t&&b[t].forEach((t=>{r.includes(t)&&p(t,a,l)})),"backtest"==t&&b[t].forEach((t=>{r.includes(t)&&s(t,a,l)})),"scatter"==t&&b[t].forEach((t=>{r.includes(t)&&o(t,a,l)})))}function s(l,e,r){t.mb[l].plotcolor;const s=r.property("__zoom"),o=(t.Yh[t.mb[l].yscaleTag].yzoomtransform,t.jx[t.mb[l].xscaleTag].xscale().XSCALE),c=t.Yh[t.mb[l].yscaleTag].yscale().TranSFormedYscale;let n=t.jx[t.mb[l].xscaleTag].zoomstatus?s.rescaleX(o):o,i=c;const m=t.Yh[t.mb[l].yscaleTag].yaxisTag,p=(t.Mr[m].range,t.Gi.backtestresultline);(0,a.Gu)(e,p,n,i,l,m)}function o(l,e,r){const s=t.Yh[t.mb[l].yscaleTag].xscaleVisibleRange;let o=[],c=[];0==s[1]?(o=t.mb[l].xdata(),c=t.mb[l].ydata()):(o=t.mb[l].xdata().slice(s[0],s[1]),c=t.mb[l].ydata().slice(s[0],s[1])),t.mb[l].plotcolor;const n=r.property("__zoom"),i=(t.Yh[t.mb[l].yscaleTag].yzoomtransform,t.jx[t.mb[l].xscaleTag].xscale().XSCALE),m=t.Yh[t.mb[l].yscaleTag].yscale().TranSFormedYscale;let p=t.jx[t.mb[l].xscaleTag].zoomstatus?n.rescaleX(i):i,b=m;const y=t.Yh[t.mb[l].yscaleTag].yaxisTag;let x=[];o.map(((t,a)=>{x.push({xData:t,yData:c[a],label:`${a}`,color:"red",size:2})})),(0,a.L3)(e,x,p,b,l,y,!1)}function c(l,e,r){const s=t.Yh[t.mb[l].yscaleTag].xscaleVisibleRange;let o=[],c=[];if(0==s[1])o=t.mb[l].xdata(),c=t.mb[l].ydata();else if(t.mb[l].clipdata){const a=function(t,a,l,e){const r=[],s=[];for(let o=0;o<t.length;o++)t[o]>=l&&t[o]<=e&&(r.push(t[o]),s.push(a[o]));return{xdata:r,ydata:s}}(t.mb[l].xdata(),t.mb[l].ydata(),s[0],s[1]);o=a.xdata,c=a.ydata}else o=t.mb[l].xdata(),c=t.mb[l].ydata();let n=t.mb[l].plotcolor;const i=r.property("__zoom"),m=(t.Yh[t.mb[l].yscaleTag].yzoomtransform,t.jx[t.mb[l].xscaleTag].xscale().XSCALE),p=t.Yh[t.mb[l].yscaleTag].yscale().TranSFormedYscale;let b=t.jx[t.mb[l].xscaleTag].zoomstatus?i.rescaleX(m):m,y=p;const x=t.Yh[t.mb[l].yscaleTag].yaxisTag,h=[],d=[];c.forEach(((t,a)=>{isNaN(t)||void 0===t||(h.push(a),d.push(t))}));const g=h.map((t=>o[t]));(0,a.U4)(e,g,d,b,y,l,x,n)}function n(l,e,r){t.Yh[t.mb[l].yscaleTag].xscaleVisibleRange;let s=[];s=t.mb[l].ydata();let o=t.mb[l].plotcolor;const c=r.property("__zoom"),n=(t.Yh[t.mb[l].yscaleTag].yzoomtransform,t.jx[t.mb[l].xscaleTag].xscale().XSCALE),i=t.Yh[t.mb[l].yscaleTag].yscale().TranSFormedYscale;let m=t.jx[t.mb[l].xscaleTag].zoomstatus?c.rescaleX(n):n,p=i;const b=t.Yh[t.mb[l].yscaleTag].yaxisTag;(0,a.xR)(e,s,m,p,b,o)}function i(l,e,r){const s=t.Yh[t.mb[l].yscaleTag].xscaleVisibleRange;let o=[],c=[];0==s[1]?(o=t.mb[l].xdata(),c=t.mb[l].ydata()):(o=t.mb[l].xdata().slice(s[0],s[1]),c=t.mb[l].ydata().slice(s[0],s[1])),t.jx[t.mb[l].xscaleTag].xsaleType;let n=t.mb[l].plotcolor;const i=r.property("__zoom"),m=(t.Yh[t.mb[l].yscaleTag].yzoomtransform,t.jx[t.mb[l].xscaleTag].xscale().XSCALE),p=t.Yh[t.mb[l].yscaleTag].yscale().TranSFormedYscale;let b=t.jx[t.mb[l].xscaleTag].zoomstatus?i.rescaleX(m):m,y=p;const x=t.Yh[t.mb[l].yscaleTag].yaxisTag,h=t.Mr[x].range;(0,a.D1)(e,o,c,b,y,l,x,h,n)}function m(l,e,r){const s=t.Yh[t.mb[l].yscaleTag].xscaleVisibleRange;let o=[],c={};if(0==s[1])o=t.mb[l].xdata(),c=t.mb[l].ydata();else{o=t.mb[l].xdata().slice(s[0],s[1]);let a=t.mb[l].ydata();Object.keys(a).forEach((t=>{c[t]=a[t].slice(s[0],s[1])}))}t.mb[l].plotcolor;const n=r.property("__zoom"),i=(t.Yh[t.mb[l].yscaleTag].yzoomtransform,t.jx[t.mb[l].xscaleTag].xscale().XSCALE),m=t.Yh[t.mb[l].yscaleTag].yscale().TranSFormedYscale;let p=t.jx[t.mb[l].xscaleTag].zoomstatus?n.rescaleX(i):i,b=m;const y=t.Yh[t.mb[l].yscaleTag].yaxisTag,x=t.Mr[y].range;(0,a.gl)(e,o,c,p,b,l,y,x,{a1:"brown",b1:"lightblue"})}function p(l,e,r){const s=t.Yh[t.mb[l].yscaleTag].xscaleVisibleRange;let o=[],c=[],n=[],i=[],m=[];0==s[1]?(o=t.mb[l].xdata(),c=t.Gi.open,n=t.Gi.high,i=t.Gi.low,m=t.Gi.close):(o=t.mb[l].xdata().slice(s[0],s[1]),c=t.Gi.open.slice(s[0],s[1]),n=t.Gi.high.slice(s[0],s[1]),i=t.Gi.low.slice(s[0],s[1]),m=t.Gi.close.slice(s[0],s[1])),t.mb[l].plotcolor;const p=r.property("__zoom"),b=(t.Yh[t.mb[l].yscaleTag].yzoomtransform,t.jx[t.mb[l].xscaleTag].xscale().XSCALE),y=t.Yh[t.mb[l].yscaleTag].yscale().TranSFormedYscale;let x=t.jx[t.mb[l].xscaleTag].zoomstatus?p.rescaleX(b):b,h=y;const d=t.Yh[t.mb[l].yscaleTag].yaxisTag;t.Mr[d].range,(0,a.$M)(e,o,c,n,i,m,x,h,l,d)}})();var s=r.v;export{s as plotonsvg};